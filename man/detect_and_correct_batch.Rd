% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/batch_correction.R
\name{detect_and_correct_batch}
\alias{detect_and_correct_batch}
\title{Detect and correct batch / covariate effects (high-level)}
\usage{
detect_and_correct_batch(
  Mval,
  metadata,
  covariates = NULL,
  tech_covars = NULL,
  top_n_pcs = 20,
  fisher_p_threshold = 0.05,
  min_samples = 4,
  use_limma = TRUE,
  output_dir = NULL,
  save_corrected = TRUE,
  plot_before_after = TRUE,
  verbose = TRUE
)
}
\arguments{
\item{Mval}{numeric matrix features x samples}

\item{metadata}{data.frame with sample_id column ordered or not (will be matched)}

\item{covariates}{character vector of covariate names (NULL -> all except sample_id)}

\item{tech_covars}{character vector of covariates considered "technical" (NULL -> use all)}

\item{top_n_pcs}{integer number of top PCs to score (default 20)}

\item{fisher_p_threshold}{numeric threshold for Fisher combined p to consider correction (default 0.05)}

\item{min_samples}{minimal number of samples with data to score a covariate}

\item{use_limma}{logical to use limma for correction if available}

\item{output_dir}{optional directory for saving results / plots}

\item{save_corrected}{logical to save corrected matrix}

\item{plot_before_after}{logical to create and save before/after plots}

\item{verbose}{logical}
}
\value{
list with Mval_corrected, batch_ranking, corrected_covariates, pca_before, pca_after, plots
}
\description{
This orchestrates PCA → ranking → covariate selection → correction → plotting.
It calls the smaller submodules above.
}
