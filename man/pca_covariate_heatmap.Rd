% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/covariate_analysis.R
\name{pca_covariate_heatmap}
\alias{pca_covariate_heatmap}
\title{PCA with covariate association heatmaps (p-value & effect size)}
\usage{
pca_covariate_heatmap(
  data_matrix,
  metadata,
  covariates,
  top_n_pcs = 20,
  remove_sex = TRUE,
  filter_sd_quantile = 1,
  output_dir = NULL,
  filename_pval = "PCA_covariate_heatmap_pval.png",
  filename_effect = "PCA_covariate_heatmap_effect.png"
)
}
\arguments{
\item{data_matrix}{numeric matrix or data.frame, rows = features, columns = samples.}

\item{metadata}{data.frame with sample metadata, must include `sample_id`.}

\item{covariates}{character vector of column names in `metadata` to test.}

\item{top_n_pcs}{number of top PCs to visualize (default 20).}

\item{remove_sex}{logical, remove features on sex chromosomes (row names starting with "chrX"/"chrY").}

\item{filter_sd_quantile}{numeric between 0 and 1, keep top X% most variable features (default 1 = keep all).}

\item{output_dir}{optional directory to save heatmaps (default NULL, skips saving).}

\item{filename_pval}{filename for p-value heatmap (default "PCA_covariate_heatmap_pval.png").}

\item{filename_effect}{filename for effect size heatmap (default "PCA_covariate_heatmap_effect.png").}
}
\value{
A list with: `pca` object, `assoc_df_pval`, `assoc_df_effect`, `covariate_importance`, `heatmap_pval`, `heatmap_effect`.
}
\description{
Computes PCA on a data matrix, quantifies association of metadata covariates with PCs,
and visualizes the top PCs as heatmaps: one for -log10(p-values), one for effect sizes.
}
